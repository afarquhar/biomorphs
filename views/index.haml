%script{:type => "text/javascript+protovis"} 
  :plain
  
    var w = document.body.clientWidth,                        
    h = document.body.clientHeight,                           
    colors = pv.Colors.category20();                          
    
    var vis = new pv.Panel()                                  
    .width(w)                                                 
    .height(h)                                                
    .fillStyle("white")                                       
    .event("mousedown", pv.Behavior.pan())                    
    .event("mousewheel", pv.Behavior.zoom());  
                   
    var force = vis.add(pv.Layout.Force)                      
    .nodes(correlations.nodes)                                
    .links(correlations.links)
    .iterations(1000)
    .springLength(100)
    ;                                      
    
    force.link.add(pv.Line)
    .title(function(d, p) { return p.real_value})
    .strokeStyle(function(d, p){ return p.real_value < 0 ?  "hsla(210, 50%, 50%, 0.5)" : "hsla(0, 50%, 50%, 0.5)"})
    .lineWidth(15)
    ;
    
    force.node.add(pv.Label)                                  
    .textAlign("right")                                       
    .text(function(d) d.nodeName)
    .font("12px sans-serif")
    ;
    
    force.node.add(pv.Dot)                                    
    .size(function(d) { return (50 )  })                      
    .fillStyle(function(d) d.fix ? "brown" : colors(d.group)) 
    .strokeStyle(function() this.fillStyle().darker())        
    .lineWidth(1)                                             
    .title(function(d) d.nodeName)                            
    .event("mousedown", pv.Behavior.drag())                   
    .event("drag", force);  
                                      
    vis.render();                                             

                                                                
                                                                
                                                                